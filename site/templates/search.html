{% extends "base.html" %}

{% block title %}Search with Tidder!{% endblock %}

{% block content %}
<style>
 .search-header {
     display: flex;
     flex-direction: column;
     align-items: center;
 }

 input {
     background-color: #fefefe;
     color: #454545;
     border-radius: 2px;
     border: none;
     margin-right: .5em;
     padding: .15em .25em;
 }
 .search-link {
     min-width: 30vw;
 }
 .search-distance {
     min-width: 5vw;
     max-width: 4em;
 }
 .search-form {
     align-self: stretch;
     display: flex;
     justify-content: center;
 }
</style>
<div class="search-header">
    <h1>Search for an image!</h1>
    <form method="get" class="search-form" search-action="/search">
        <input class="search-link" name="imagelink" required="true" type="url"
               value="{% match sent %}
                      {%- when Some with (sent) %}
                      {{- sent.link }}
                      {%- else %}
                      {%- endmatch %}"/>
        <input class="search-distance" name="distance" type="number"
               min="0" max="64" placeholder="{{ common::DEFAULT_DISTANCE }}"
               value="{% match sent %}
                      {%- when Some with (sent) %}
                      {%- match sent.distance %}
                      {%- when Some with (distance) %}
                      {{- distance }}
                      {%- else %}
                      {%- endmatch %}
                      {%- else %}
                      {%- endmatch %}"/>
        <input class="search-button" type="submit" value="Search" />
    </form>
    {% match sent %}
    {% when Some with (sent) %}
    <p>You searched for <a href="{{ sent.link }}">{{ sent.link }}</a></p>
    {% match sent.findings %}
    {% when Err with (message) %}
    <p>Error: {{message}}</p>
    {% else %}
    {% endmatch %}
    {% else %}
    <p>No search yet...</p>
    {% endmatch %}
</div>
{% match sent %}
{% when Some with (sent) %}
{% match sent.findings %}
{% when Ok with (findings) %}
{{ findings|safe }}
{% else %}
{% endmatch %}
{% else %}
{% endmatch %}
{% endblock %}
